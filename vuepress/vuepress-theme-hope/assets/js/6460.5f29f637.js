"use strict";(self.webpackChunkvuepress_hope=self.webpackChunkvuepress_hope||[]).push([[6460],{6460:(e,t,n)=>{n.d(t,{pageviewCount:()=>i});const r={"Content-Type":"application/json"},a=e=>`${e.replace(/\/?$/,"/")}api/`,o=e=>{const t=((e="")=>e.replace(/\/$/u,""))(e);return(e=>/^(https?:)?\/\//.test(e))(t)?t:`https://${t}`},s=e=>{"AbortError"!==e.name&&console.error(e.message)},l=e=>e.dataset.path||null,p=(e,t)=>{t.forEach(((t,n)=>{t.innerText=e[n].toString()}))},i=({serverURL:e,path:t=window.location.pathname,selector:n=".waline-pageview-count",update:i=!0,lang:h=navigator.language})=>{const c=new AbortController,g=Array.from(document.querySelectorAll(n)),u=e=>{const n=l(e);return null!==n&&t!==n},y=n=>(({serverURL:e,lang:t,paths:n,signal:r})=>(({serverURL:e,lang:t,paths:n,type:r,signal:o})=>fetch(`${a(e)}article?path=${encodeURIComponent(n.join(","))}&type=${encodeURIComponent(r.join(","))}&lang=${t}`,{signal:o}).then((e=>e.json())))({serverURL:e,lang:t,paths:n,type:["time"],signal:r}).then((e=>Array.isArray(e)?e:[e])))({serverURL:o(e),paths:n.map((e=>l(e)||t)),lang:h,signal:c.signal}).then((e=>p(e,n))).catch(s);if(i){const n=g.filter((e=>!u(e))),s=g.filter(u);(e=>(({serverURL:e,lang:t,path:n,type:o,action:s})=>fetch(`${a(e)}article?lang=${t}`,{method:"POST",headers:r,body:JSON.stringify({path:n,type:o,action:s})}).then((e=>e.json())).then((e=>((e,t="")=>{if("object"==typeof e&&e.errno)throw new TypeError(`${t} failed with ${e.errno}: ${e.errmsg}`);return e})(e,"Update counter").data)))({...e,type:"time",action:"inc"}))({serverURL:o(e),path:t,lang:h}).then((([e])=>p(new Array(n.length).fill(e),n))),s.length&&y(s)}else y(g);return c.abort.bind(c)}}}]);